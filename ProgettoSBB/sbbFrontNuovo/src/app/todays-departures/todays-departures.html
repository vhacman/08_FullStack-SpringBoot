<div class="w3-container" style="padding: 0 8px 8px; margin-top: 16px;">

  <div class="departures-header-box">
    <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px;">
      <h2 class="page-title" style="margin: 0;">Partenze di Oggi</h2>
      <button class="refresh-btn" (click)="refresh()" title="Aggiorna">
        <i class="bi bi-arrow-clockwise"></i>
      </button>
    </div>
  </div>

  <!-- Stato vuoto -->
  @if (toCleanBookings().length === 0 && cleanedBookings().length === 0) {
    <div class="w3-panel w3-leftbar w3-padding-16 empty-state">
      <p>Nessuna partenza prevista per oggi.</p>
    </div>
  }

  <!-- Lista partenze da pulire -->
  @if (toCleanBookings().length > 0) {
    <div class="bookings-list">
      @for (booking of toCleanBookings(); track booking.id) {
        <app-booking-row [booking]="booking" (completeDone)="onCleanedDone($event)"></app-booking-row>
      }
    </div>
  }

</div>

<!-- Sezione Camere Pulite separata -->
@if (cleanedBookings().length > 0) {
  <div class="cleaned-section" style="padding: 0 8px 8px; margin-top: 16px;">
    <div class="collapsible-section">

      <div class="collapsible-header orange" (click)="toggleCleaned()">
        <span>Camere Pulite</span>
        <span class="count-badge orange-badge">{{ cleanedBookings().length }}</span>
        <span class="chevron">@if (cleanedExpanded()) { ▲ } @else { ▼ }</span>
      </div>

      @if (cleanedExpanded()) {
        <div class="expanded-list">
          @for (b of cleanedBookings(); track b.id) {
            <app-booking-row [booking]="b"></app-booking-row>
          }
        </div>
      }

    </div>
  </div>
}
